@model IEnumerable<Discounts.Application.DTOs.Offer.OfferDto>

@{
	ViewData["Title"] = "ჩემი შეთავაზებები";
}

<div class="container mt-5">
	<div class="d-flex justify-content-between align-items-center mb-4">
		<h2><i class="bi bi-tags text-primary"></i> ჩემი შეთავაზებები</h2>
		<a asp-action="CreateOffer" class="btn btn-primary"><i class="bi bi-plus-circle"></i> ახალის დამატება</a>
	</div>
	<hr />

	@if (TempData["ErrorMessage"] != null)
	{
		<div class="alert alert-danger alert-dismissible fade show">@TempData["ErrorMessage"]<button type="button" class="btn-close" data-bs-dismiss="alert"></button></div>
	}

	<div class="card shadow-sm border-0">
		<div class="card-body p-0">
			@if (!Model.Any())
			{
				<div class="alert alert-light text-center m-0 py-5">
					<i class="bi bi-box-seam text-muted fs-1"></i>
					<p class="mt-3 mb-0 text-muted">თქვენ ჯერ არ გაქვთ დამატებული ფასდაკლებები.</p>
				</div>
			}
			else
			{
				<table class="table table-hover align-middle mb-0">
					<thead class="table-dark">
						<tr>
							<th>სურათი</th>
							<th>სათაური</th>
							<th>ფასი (საწყისი / ფასდაკლებული)</th>
							<th>სტატუსი</th>
							<th>შექმნის თარიღი</th>
							<th class="text-end">მოქმედება</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var offer in Model)
						{
							<tr>
								<td>
									<img src="@offer.ImageUrl" alt="@offer.Title" style="width: 50px; height: 50px; object-fit: cover;" class="rounded" />
								</td>
								<td class="fw-bold">@offer.Title</td>
								<td>
									<span class="text-decoration-line-through text-muted small">@offer.OriginalPrice ₾</span>
									<br />
									<span class="text-success fw-bold">@offer.DiscountPrice ₾</span>
								</td>
								<td>
									@if (offer.Status == "Active")
									{
										<span class="badge bg-success">აქტიური</span>
									}
									else if (offer.Status == "Pending")
									{
										<span class="badge bg-warning text-dark">განხილვაშია</span>
									}
									else if (offer.Status == "Rejected")
									{
										<span class="badge bg-danger">უარყოფილია</span>
										@if (!string.IsNullOrEmpty(offer.RejectionReason))
										{
											<div class="mt-1 small text-danger" title="უარყოფის მიზეზი">
												<i class="bi bi-exclamation-circle"></i> @offer.RejectionReason
											</div>
										}
									}
									else
									{
										<span class="badge bg-secondary">@offer.Status</span>
									}
								</td>
								<td class="text-muted small">@offer.CreatedAt.ToLocalTime().ToString("g")</td>

								<td class="text-end">
									<a asp-action="Edit" asp-route-id="@offer.Id" class="btn btn-sm btn-outline-primary" title="რედაქტირება">
										<i class="bi bi-pencil-square"></i> რედაქტირება
									</a>
								</td>
							</tr>
						}
					</tbody>
				</table>
			}
		</div>
	</div>
</div>
